<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Get started</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Get started</h1>



<p>In order to get up to speed with the <code>portvine</code> package
you will find in this vignette:</p>
<ul>
<li><strong>Exemplary workflows</strong> for the unconditional and
conditional risk measure estimation</li>
<li><strong>Opinionated visualization functions</strong> not included in
the package</li>
<li>Some notes on <strong>backtesting</strong> the estimated risk
measures</li>
</ul>
<p>What you do not find here is a theoretical description of the
algorithms. For this purpose there is the <strong>Under the hood
article</strong> on the package website and actually it is probably most
often the better idea to start off with the theoretical view. For a very
detailed theoretical view with lots of illustrations and two case
studies have a look at my thesis - <a href="https://mediatum.ub.tum.de/1658240">Sommer (2022)</a>.</p>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################### required #################### </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(portvine)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">#################### optional #################### </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## the following packages are only necessary for the visualizations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for visualization:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>(<span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># some data wrangling for visualizations</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<p>The sampling within the estimation algorithms is reproducible with a
fixed seed (this also holds for parallel processing).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="the-data-set" class="section level2">
<h2>The data set</h2>
<p>With the package comes a small test data set containing 1000 daily
log returns of 3 stocks (Apple ~ AAPL, Alphabet ~ GOOG and Amazon ~
AMZN).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;sample_returns_small&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sample_returns_small)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            AAPL          GOOG         AMZN</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1:  0.005221515 -0.0063910288 -0.016940943</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2:  0.019702688  0.0232542613  0.016639145</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3:  0.019878308 -0.0006788564 -0.004209719</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4: -0.005595481  0.0065947671 -0.000176859</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5: -0.024806737 -0.0049333142  0.009580031</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6:  0.015416878  0.0113819042  0.018446965</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sample_returns_small)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1000    3</span></span></code></pre></div>
<p>So as one financial year is comprised of roughly 250 days one has the
data of roughly 4 years. The aim is now to estimate portfolio level risk
measures for the last 40 days i.e. the interval <span class="math inline">\([960,1000]\)</span>. For a realistic scenario this
would of course be a very short window. First one specifies the marginal
assetwise time series models.</p>
</div>
<div id="specify-marginal-models" class="section level2">
<h2>Specify marginal models</h2>
<p>In practice one would for example like to refit the marginal models
every two months which is in trading days roughly 50 days, but here we
will refit every 20 days. The training data size is already specified by
the interval of interest i.e. here one uses the whole available past of
the first marginal window which has the size 960.</p>
<div id="the-unconditional-case" class="section level3">
<h3>The unconditional case</h3>
<p>Here in the unconditional case one will not deviate from the default
thus for all marginal models an ARMA(1,1)-GARCH(1,1) model is fitted.
The default model can be assessed via the function
<code>default_garch_spec()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default_garch_spec</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *---------------------------------*</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *       GARCH Model Spec          *</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; *---------------------------------*</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional Variance Dynamics    </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GARCH Model      : sGARCH(1,1)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Variance Targeting   : FALSE </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional Mean Dynamics</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mean Model       : ARFIMA(1,0,1)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Include Mean     : TRUE </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; GARCH-in-Mean        : FALSE </span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional Distribution</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Distribution :  sstd </span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Includes Skew    :  TRUE </span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Includes Shape   :  TRUE </span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Includes Lambda  :  FALSE</span></span></code></pre></div>
<p>The marginal model specifications are then collected in a
<code>marginal_settings</code> object as shown below.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>uncond_marg_settings <span class="ot">&lt;-</span> <span class="fu">marginal_settings</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_size =</span> <span class="dv">960</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">refit_size =</span> <span class="dv">20</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="the-conditional-case" class="section level3">
<h3>The conditional case</h3>
<p>For the conditional case one will use a more individual
specification. One changes the default to an ARMA(1,2)-GARCH(1,1) model
while sticking with the default for the Amazon stock.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cond_marg_settings <span class="ot">&lt;-</span> <span class="fu">marginal_settings</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_size =</span> <span class="dv">960</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">refit_size =</span> <span class="dv">20</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">individual_spec =</span> <span class="fu">list</span>(<span class="st">&quot;AMZN&quot;</span> <span class="ot">=</span> <span class="fu">default_garch_spec</span>()),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">default_spec =</span> <span class="fu">default_garch_spec</span>(<span class="at">ma =</span> <span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The next step is to specify the settings for the vine fitting.</p>
</div>
</div>
<div id="specify-vine-copula-models" class="section level2">
<h2>Specify vine copula models</h2>
<p>Here one would like to refit the vine copula models every 10 or 20
days which is allowed by the package as 20 is dividable by 10. One would
like to capture the dependence on a training set of 100 trading days for
each rolling window.</p>
<div id="the-unconditional-case-1" class="section level3">
<h3>The unconditional case</h3>
<p>For the unconditional case one will use the default
<code>vine_type</code> which is the R-vine. For the bivariate building
blocks of the vine copula one will restrict oneself to the single
parametric pair copulas. For other possible choices have a look at the
help page of the function <code>rvinecopulib::bicop()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>uncond_vine_settings <span class="ot">&lt;-</span> <span class="fu">vine_settings</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_size =</span> <span class="dv">100</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">refit_size =</span> <span class="dv">10</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family_set =</span> <span class="st">&quot;onepar&quot;</span>, <span class="co"># valid bivariate building blocks</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vine_type =</span> <span class="st">&quot;rvine&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="the-conditional-case-1" class="section level3">
<h3>The conditional case</h3>
<p>In the conditional case up to now only D-vine copulas are allowed. As
copula families one will pick some arbitrary ones for this example. Note
that “parametric” would be the most nonrestrictive valid option
here.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cond_vine_settings <span class="ot">&lt;-</span> <span class="fu">vine_settings</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">train_size =</span> <span class="dv">100</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">refit_size =</span> <span class="dv">20</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family_set =</span> <span class="fu">c</span>(<span class="st">&quot;gumbel&quot;</span>, <span class="st">&quot;joe&quot;</span>, <span class="st">&quot;t&quot;</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vine_type =</span> <span class="st">&quot;dvine&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now one is ready to perform the actual risk measure estimation.</p>
</div>
</div>
<div id="estimate-the-risk-measures" class="section level2">
<h2>Estimate the risk measures</h2>
<p>The risk measures should be estimated at both popular confidence
levels 1% and 2.5%. In terms of risk measures one would like to estimate
the Value at Risk (VaR) and the expected shortfall (ES) with mean
estimation based on here a very small and not realistic sample size of
50. A realistic one would be 100000.</p>
<div id="the-unconditional-case-2" class="section level3">
<h3>The unconditional case</h3>
<p>Here an equally weighted portfolio of the three stocks is assumed
thus one can leave the default <code>NULL</code>value for the
<code>weights</code> argument. The trace argument set to
<code>TRUE</code> will trigger the printing of some basic information
during training. This workhorse function of the package is very well
suited for parallel and even nested parallel processing. For details
have a look at the help page and consult the article covering the
parallel processing on the package website for some performance
measurements. Down below one can facilitate basic parallel processing by
just using the commented code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## specify parallel strategy</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># future::plan(&quot;multisession&quot;, workers = 4)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>uncond_risk_roll <span class="ot">&lt;-</span> <span class="fu">estimate_risk_roll</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sample_returns_small,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="cn">NULL</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">marginal_settings =</span> uncond_marg_settings,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vine_settings =</span> uncond_vine_settings,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.025</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_measures =</span> <span class="fu">c</span>(<span class="st">&quot;VaR&quot;</span>, <span class="st">&quot;ES_mean&quot;</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_samples =</span> <span class="dv">50</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> <span class="cn">TRUE</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fit marginal models:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AAPL  GOOG  AMZN  </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fit vine copula models and estimate risk.</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vine windows:</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (1/4) (2/4) (3/4) (4/4)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="do">## return to default sequential settings (cut off any background processes)</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># future::plan(&quot;sequential&quot;)</span></span></code></pre></div>
<p>Having estimated the risk measures one can get a short and more
detailed summary of the process by printing the object and calling the
summary method.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>uncond_risk_roll</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &lt;portvine_roll&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of ARMA-GARCH/ marginal windows: 2 </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of vine windows: 4 </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Risk measures estimated: VaR ES_mean </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alpha levels used: 0.01 0.025 </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time taken: 0.1353 minutes</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(uncond_risk_roll)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &lt;portvine_roll&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Marginal models ---</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of ARMA-GARCH/ marginal windows: 2 </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Train size:  960 </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refit size:  20 </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Vine copula models ---</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of vine windows: 4 </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Train size:  100 </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refit size:  10 </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vine copula type:  rvine </span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vine family set:  onepar </span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Risk estimation ---</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Risk measures estimated: VaR ES_mean </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alpha levels used: 0.01 0.025 </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of estimated risk measures: 160 </span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples for each risk estimation: 50 </span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time taken: 0.1353 minutes.</span></span></code></pre></div>
</div>
<div id="the-conditional-case-2" class="section level3">
<h3>The conditional case</h3>
<p>The package currently supports up to two conditioning assets. Here
the single conditional case will be covered but the double conditional
case is almost identical. One will choose the Amazon stock to be the
conditioning asset (via the <code>cond_vars</code> argument).
Furthermore one will give the Alphabet stock a greater weight and the
weight of the conditioning asset must of course be zero. Note that the
weights for example according to market capitalization can be even
changing on the vine window granularity level. The <code>cond_u</code>
argument then specifies the quantile level of the conditioning value. So
a small quantile level will emulate the behavior of a very weak
performance of the conditioning Amazon stock. Details on all arguments
are given on the help page.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cond_risk_roll <span class="ot">&lt;-</span> <span class="fu">estimate_risk_roll</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sample_returns_small,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">c</span>(<span class="st">&quot;AAPL&quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;GOOG&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;AMZN&quot;</span> <span class="ot">=</span> <span class="dv">0</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">marginal_settings =</span> cond_marg_settings,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vine_settings =</span> cond_vine_settings,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.025</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_measures =</span> <span class="fu">c</span>(<span class="st">&quot;VaR&quot;</span>, <span class="st">&quot;ES_mean&quot;</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_samples =</span> <span class="dv">50</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond_vars =</span> <span class="st">&quot;AMZN&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cond_u =</span> <span class="fl">0.1</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Having estimated the conditional risk measures one can again get a
short and more detailed summary of the process by printing the object
and calling the summary method.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cond_risk_roll</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &lt;cond_portvine_roll&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional variable(s): AMZN </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of ARMA-GARCH/ marginal windows: 2 </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of vine windows: 2 </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Risk measures estimated: VaR ES_mean </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alpha levels used: 0.01 0.025 </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time taken: 0.1345 minutes</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cond_risk_roll)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class &lt;cond_portvine_roll&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Conditional settings ---</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditional variable(s): AMZN </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of conditional estimated risk measures: 320 </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Conditioning quantiles: 0.1 </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Marginal models ---</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of ARMA-GARCH/ marginal windows: 2 </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Train size:  960 </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refit size:  20 </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Vine copula models ---</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of vine windows: 2 </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Train size:  100 </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refit size:  20 </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vine copula type:  dvine </span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vine family set:  gumbel joe t </span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- Risk estimation ---</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Risk measures estimated: VaR ES_mean </span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Alpha levels used: 0.01 0.025 </span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of estimated risk measures: 160 </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of samples for each risk estimation: 50 </span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Time taken: 0.1345 minutes.</span></span></code></pre></div>
</div>
</div>
<div id="assess-marginal-model-quality" class="section level2">
<h2>Assess marginal model quality</h2>
<p>In order to extract the marginal models one can use the function
<code>fitted_marginals()</code>. The result is a named list with a
<code>rugarch::ugarchroll</code> object for each asset. These objects
contain all fitted marginal time series models.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">fitted_marginals</span>(uncond_risk_roll))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AAPL&quot; &quot;GOOG&quot; &quot;AMZN&quot;</span></span></code></pre></div>
<p>For the extraction of the fitted residuals for a residual analysis
the <code>portvine</code> package further provides the utility function
<code>roll_residuals()</code>. In the following an opinionated
visualization function useful for a visual residual analysis is given
and used. It allows to visualize the raw standardized residuals, the
empirical autocorrelation function of them and the results (p-values) of
Ljung-Box tests for serial correlation at different lags. This is useful
to assess the appropriateness of the mean equation of the ARMA-GARCH
model. In order to assess the volatility equation one can have a look at
the same visualization for the squared standardized residuals. As the
function is highly opinionated it was not integrated in the
<code>portvine</code> package.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># An opinionated function for residual analysis. Note this function has no </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># input checks and is not tested in any ways.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: named list with a composition of residual plots for each asset</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>marg_resid_viz_list <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  roll, <span class="co"># portvine_roll or cond_portvine_roll object</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">asset_names =</span> <span class="cn">NULL</span>, <span class="co"># filter for certain  assets</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">marg_window =</span> <span class="dv">1</span>, <span class="co"># specify a marginal window</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">squared =</span> <span class="cn">FALSE</span> <span class="co"># if set to true the results for the squared stand. residuals</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># are displayed</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  fitted_marginals <span class="ot">&lt;-</span> <span class="fu">fitted_marginals</span>(roll)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(asset_names)) asset_names <span class="ot">&lt;-</span> <span class="fu">fitted_vines</span>(roll)[[<span class="dv">1</span>]]<span class="sc">$</span>names</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    asset_names,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(asset_name) {</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># use again a utility function from the portvine package to extract the </span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># fitted standardized residuals</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      model_resid <span class="ot">&lt;-</span> <span class="fu">roll_residuals</span>(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        fitted_marginals[[asset_name]], marg_window</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (squared) model_resid <span class="ot">&lt;-</span> model_resid<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      simple_exploratory <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">resid =</span> model_resid) <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">seq</span>(<span class="fu">length</span>(model_resid))) <span class="sc">%&gt;%</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;t&quot;</span>, <span class="at">y =</span> <span class="fu">ifelse</span>(squared, <span class="fu">expression</span>(z[t]<span class="sc">^</span><span class="dv">2</span>),<span class="fu">expression</span>(z[t])),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> asset_name) <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      acf_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">acf =</span> <span class="fu">as.numeric</span>(<span class="fu">acf</span>(model_resid, <span class="at">type =</span> <span class="st">&quot;cor&quot;</span>, <span class="at">lag.max =</span> <span class="dv">20</span>,</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(lag <span class="sc">!=</span> <span class="dv">0</span> <span class="sc">&amp;</span> lag <span class="sc">&lt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="sc">/</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sqrt</span>(<span class="fu">length</span>(model_resid)),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;longdash&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#92B8DE&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag, <span class="at">xend =</span> lag, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> acf)) <span class="sc">+</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag, <span class="at">y =</span> acf)) <span class="sc">+</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;h&quot;</span>, <span class="at">y =</span> <span class="st">&quot;ACF(h)&quot;</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>      ljungplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">pval =</span> <span class="fu">sapply</span>(</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(i) <span class="fu">Box.test</span>(model_resid, <span class="at">lag =</span> i,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">&quot;Lju&quot;</span>)<span class="sc">$</span>p.value),</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.05</span>,</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;longdash&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#92B8DE&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag, <span class="at">y =</span> pval)) <span class="sc">+</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag, <span class="at">y =</span> pval)) <span class="sc">+</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;h&quot;</span>, <span class="at">y =</span> <span class="st">&quot;p-value of Ljung-Box test at lag h&quot;</span>)</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>      (simple_exploratory <span class="sc">/</span> (ljungplot <span class="sc">+</span> acf_plot)) <span class="sc">+</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot_layout</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Apply the function to the result of the unconditional estimation and
display the residual plots for Apple and Alphabet.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>uncond_residual_viz <span class="ot">&lt;-</span> <span class="fu">marg_resid_viz_list</span>(uncond_risk_roll)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>uncond_residual_viz_squared <span class="ot">&lt;-</span> <span class="fu">marg_resid_viz_list</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  uncond_risk_roll, <span class="at">squared =</span> <span class="cn">TRUE</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>uncond_residual_viz<span class="sc">$</span>AAPL</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>uncond_residual_viz_squared<span class="sc">$</span>GOOG</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For a better overview of all assets, especially in higher dimensions,
a heatmap with the p-values of the Ljung-Box tests can be useful. For
this I will now showcase another opinionated utility function.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function creates a heatmap of Ljung Box test p-values for a </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (cond-)portvine_roll object. Note this function again has no </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># input checks and is not tested in any ways.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Output: The heatmap (ggplot2 object)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ljung_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(roll, <span class="at">roll_num =</span> <span class="dv">1</span>, <span class="at">squared =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  asset_names <span class="ot">&lt;-</span> <span class="fu">fitted_vines</span>(roll)[[<span class="dv">1</span>]]<span class="sc">$</span>names</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  roll_marginals <span class="ot">&lt;-</span> <span class="fu">fitted_marginals</span>(roll)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ljung_data <span class="ot">&lt;-</span> <span class="fu">sapply</span>(asset_names, <span class="cf">function</span>(asset_name) {</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    model_resid <span class="ot">&lt;-</span> <span class="fu">roll_residuals</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      roll_marginals[[asset_name]], <span class="at">roll_num =</span> roll_num</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (squared) model_resid <span class="ot">&lt;-</span> model_resid<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(i) <span class="fu">Box.test</span>(model_resid, <span class="at">lag =</span> i, <span class="at">type =</span> <span class="st">&quot;Lju&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  ljung_data <span class="ot">&lt;-</span> ljung_data <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">lag =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(ljung_data))) <span class="sc">%&gt;%</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>lag, <span class="at">names_to =</span> <span class="st">&quot;asset&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;pval&quot;</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(ljung_data<span class="sc">$</span>pval <span class="sc">&gt;=</span> <span class="fl">0.05</span>)) {</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    legend_scale <span class="ot">&lt;-</span> <span class="fu">scale_fill_gradient</span>(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">low =</span> <span class="st">&quot;#92B8DE&quot;</span>, <span class="at">high =</span> <span class="st">&quot;#2a82db&quot;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    legend_scale <span class="ot">&lt;-</span> <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;#db4f59&quot;</span>,<span class="st">&quot;#C37285&quot;</span> ,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;#92B8DE&quot;</span>, <span class="st">&quot;#2a82db&quot;</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span> <span class="sc">-</span> <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="dv">1</span>)),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.05</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="fl">0.05</span>),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">nbin =</span> <span class="dv">1000</span>))</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  ljung_data <span class="sc">%&gt;%</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lag, <span class="at">y =</span> asset, <span class="at">fill =</span> pval)) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;h&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;p-value&quot;</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Results of the Ljung-Box tests&quot;</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Rolling window:&quot;</span>, roll_num)) <span class="sc">+</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    legend_scale <span class="sc">+</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This time one uses the result of the conditional risk measure
estimation for a display of the function for the residual analysis.
<span class="math inline">\(h\)</span> again denotes the lag.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ljung_heatmap</span>(uncond_risk_roll)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>P-values lower than 0.05 would be highlighted in red on the heatmap
for easy spotting.</p>
</div>
<div id="a-look-at-the-fitted-vine-copulas" class="section level2">
<h2>A look at the fitted vine copulas</h2>
<p>Next up one can have a look at the fitted vine copulas. For this
again a utility function is available in the <code>portvine</code>
package. The function <code>fitted_vines()</code> extracts all fitted
vines in a list, one vine copula object for each vine window.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>uncond_fitted_vines <span class="ot">&lt;-</span> <span class="fu">fitted_vines</span>(uncond_risk_roll)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>uncond_fitted_vines[[<span class="dv">3</span>]]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3-dimensional vine copula fit (&#39;vinecop&#39;)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nobs = 100   logLik = 56   npars = 3   AIC = -106.01   BIC = -98.19</span></span></code></pre></div>
<p>As the list elements are <code>rvinecopulib::vinecop</code> objects
one can further analyze them with tools from the great <a href="https://vinecopulib.github.io/rvinecopulib/"><code>rvinecopulib</code></a>
package e.g. plot the objects to exploit the graphical representation,
which aids interpretability.</p>
</div>
<div id="analyze-the-risk-measure-estimates" class="section level2">
<h2>Analyze the risk measure estimates</h2>
<p>The last utility function that is presented in this vignette is
<code>risk_estimates()</code> and as the name suggests it can be used to
easily extract the risk measure estimates from the estimation result
object. One can not only filter by the risk measure, confidence levels
but also choose between an output as <code>data.frame</code> or
<code>data.table</code>. Moreover optionally it calculates a logical
column indicating whether the risk measure was exceeded.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## a glimpse at the tidy data.frame with all estimated risk measures</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">risk_estimates</span>(uncond_risk_roll), <span class="dv">10</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    risk_measure    risk_est alpha row_num vine_window     realized</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           VaR -0.06642110 0.010     961           1 -0.001246766</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           VaR -0.05021659 0.025     961           1 -0.001246766</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       ES_mean -0.08115332 0.010     961           1 -0.001246766</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       ES_mean -0.06612045 0.025     961           1 -0.001246766</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5           VaR -0.08815168 0.010     962           1  0.048242745</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6           VaR -0.05064118 0.025     962           1  0.048242745</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       ES_mean -0.12112020 0.010     962           1  0.048242745</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       ES_mean -0.08747886 0.025     962           1  0.048242745</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9           VaR -0.07056187 0.010     963           1  0.011817887</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10          VaR -0.06257534 0.025     963           1  0.011817887</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="do">## a glimpse at the estimated VaR at confidence level 1% with exceeded column</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">risk_estimates</span>(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    uncond_risk_roll,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_measures =</span> <span class="st">&quot;VaR&quot;</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">exceeded =</span> <span class="cn">TRUE</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   risk_measure    risk_est alpha row_num vine_window     realized exceeded</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          VaR -0.06642110  0.01     961           1 -0.001246766    FALSE</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          VaR -0.08815168  0.01     962           1  0.048242745    FALSE</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3          VaR -0.07056187  0.01     963           1  0.011817887    FALSE</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4          VaR -0.07643047  0.01     964           1  0.012662108    FALSE</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5          VaR -0.09512079  0.01     965           1  0.023044956    FALSE</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6          VaR -0.14389637  0.01     966           1 -0.013655480    FALSE</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="do">## of course also applies for the conditional case</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">risk_estimates</span>(</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    cond_risk_roll,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_measures =</span> <span class="st">&quot;ES_mean&quot;</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">cond_u =</span> <span class="fu">c</span>(<span class="st">&quot;resid&quot;</span>, <span class="fl">0.1</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   risk_measure    risk_est alpha row_num         AMZN cond_u vine_window</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      ES_mean -0.09972157  0.01     961 -0.025134330    0.1           1</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      ES_mean -0.04771672  0.01     961 -0.010373232  resid           1</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      ES_mean -0.14477330  0.01     962 -0.022958822    0.1           1</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      ES_mean -0.03292465  0.01     962  0.018511442  resid           1</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      ES_mean -0.10651503  0.01     963 -0.022824470    0.1           1</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      ES_mean -0.02974445  0.01     963  0.009607753  resid           1</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       realized</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.007439544</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0.007439544</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.039189494</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.039189494</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -0.002692899</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 -0.002692899</span></span></code></pre></div>
<p>This tidy representation can be easily used for visualizations. For
example comparisons of risk measures over time.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">risk_estimates</span>(uncond_risk_roll, <span class="at">alpha =</span> <span class="fl">0.025</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> realized), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> risk_est,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">factor</span>(risk_measure))) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#92B8DE&quot;</span>, <span class="st">&quot;#477042&quot;</span>)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;trading day&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;portfolio log returns&quot;</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;Risk measure&quot;</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Comparison of unconditional risk measure estimates at </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="st">       confidence level 2.5%&quot;</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Realized log returns in &quot;</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&lt;span style=&#39;color:&quot;</span>,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&#39;&gt;**grey**&lt;/span&gt;&quot;</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or one can explore exceedances.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">risk_estimates</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  uncond_risk_roll,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_measures =</span> <span class="fu">c</span>(<span class="st">&quot;VaR&quot;</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exceeded =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> realized), <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> risk_est), <span class="at">col =</span> <span class="st">&quot;#92B8DE&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> realized), <span class="at">col =</span> <span class="st">&quot;#db4f59&quot;</span>, </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exceeded)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;trading days&quot;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;portfolio log returns&quot;</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;Exceeded&quot;</span>,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Exceedances are highlighted in &quot;</span>,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&lt;span style=&#39;color:&quot;</span>,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;#db4f59&quot;</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&#39;&gt;**red**&lt;/span&gt;&quot;</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;.&quot;</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Risk measure: VaR with confidence level 1%&quot;</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the conditional case one can first have a look at how the
different conditional strategies behave. On the one side a conditioning
value based on the quantile level 0.1 was forecasted (below shown in
light blue) and on the other side the residual strategy is by default
set to the one that uses the realized residuals (below shown in green,
it should almost overlay the grey realized line). Those are only for the
comparison as they conceptually are an oracle as the actual realized
conditional asset returns would not be known at sampling time.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">risk_estimates</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  cond_risk_roll,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk_measures =</span> <span class="st">&quot;ES_mean&quot;</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> sample_returns_small[<span class="dv">961</span><span class="sc">:</span><span class="dv">1000</span>, <span class="st">&quot;AMZN&quot;</span>],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">961</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> AMZN), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">size =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> AMZN, <span class="at">col =</span> <span class="fu">factor</span>(cond_u)),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#92B8DE&quot;</span>, <span class="st">&quot;#477042&quot;</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">&quot;Conditional strategy&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Conditional variable: AMZN&quot;</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;trading days&quot;</span>, <span class="at">y =</span> <span class="st">&quot;log returns of the asset AMZN&quot;</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Realized log returns in &quot;</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&lt;span style=&#39;color:&quot;</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&#39;&gt;**grey**&lt;/span&gt;&quot;</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then one can compare the resulting conditional risk measure
estimates.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">risk_estimates</span>(cond_risk_roll, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">risk_measures =</span> <span class="st">&quot;ES_mean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> realized), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> row_num, <span class="at">y =</span> risk_est,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="fu">factor</span>(cond_u))) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#477042&quot;</span>, <span class="st">&quot;#92B8DE&quot;</span>)) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;trading day&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;portfolio log returns&quot;</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;Conditional strategy&quot;</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Comparison of conditional risk measure estimates at </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">       confidence level 2.5%&quot;</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">&quot;Realized log returns in &quot;</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&lt;span style=&#39;color:&quot;</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;&#39;&gt;**grey**&lt;/span&gt;&quot;</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This is of course just the tip of the iceberg and countless other
visualizations are possible at that point. Especially for multiple
conditional quantile levels in a stress testing scenario. An especially
promising comparison is the one comparing multiple levels of quantile
based risk measure estimates with the respective unconditional one. This
allows to assess how well the unconditional approach accounts for the
market risk on the portfolio associated with fluctuations of the
conditional asset(s).</p>
<p>The interpretation is left out for these exemplary workflows.
Detailed case studies can again be found in <a href="https://mediatum.ub.tum.de/1658240">Sommer (2022)</a>.</p>
</div>
<div id="backtesting-the-estimated-risk-measures" class="section level2">
<h2>Backtesting the estimated risk measures</h2>
<p>The risk measure estimation performed is in many cases performed with
the goal of backtesting in mind. This can be easily achieved given the
objects returned by the <code>estimate_risk_roll()</code> function. As
there are already excellent resources for performing these here are some
suggestions for implementations that can be applied in this portfolio
level setting:</p>
<ul>
<li><strong>Value at Risk backtesting</strong>: The package <a href="https://CRAN.R-project.org/package=rugarch"><code>rugarch</code></a>
contains the straightforward to use function
<code>rugarch::VaRTest()</code>. It features classical backtests based
on violation sequences.</li>
<li><strong>Expected shortfall backtesting</strong>: The package <a href="https://CRAN.R-project.org/package=esback"><code>esback</code></a>
contains a suite of easy to use and theoretically backed backtests for
the expected shortfall.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
